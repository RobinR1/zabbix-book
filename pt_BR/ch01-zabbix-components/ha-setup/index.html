
<!doctype html>
<html lang="pt" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Set up Zabbix High Availability with clustered servers, shared DB, and Keepalived
for VIP failover—ensuring zero-downtime monitoring.
">
      
      
        <meta name="author" content="The Monitoring Penmasters">
      
      
        <link rel="canonical" href="https://thezabbixbook.com/pt_BR/ch01-zabbix-components/ha-setup/">
      
      
        <link rel="prev" href="../basic-installation/">
      
      
        <link rel="next" href="../../ch02-zabbix-installation/chapter/">
      
      
        
          <link rel="alternate" href="../../../fr/ch01-zabbix-components/ha-setup/" hreflang="fr">
        
          <link rel="alternate" href="../../../nl/ch01-zabbix-components/ha-setup/" hreflang="nl">
        
          <link rel="alternate" href="./" hreflang="pt_BR">
        
          <link rel="alternate" href="../../../ru/ch01-zabbix-components/ha-setup/" hreflang="ru">
        
          <link rel="alternate" href="../../../ch01-zabbix-components/ha-setup/" hreflang="en">
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>HA Setup - Zabbix Book</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        
        <link rel="stylesheet" href="../../../assets/external/fonts.googleapis.com/css.af67bdb9.css">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Nunito"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../../stylesheets/linewrap.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
    
    

    <meta property="og:title" content="HA Setup">
    <meta property="og:description" content="Set up Zabbix High Availability with clustered servers, shared DB, and Keepalived for VIP failover—ensuring zero-downtime monitoring.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://thezabbixbook.com/pt_BR/ch01-zabbix-components/ha-setup/">
    <meta property="og:image" content="https://www.thezabbixbook.com/assets/social-card.jpg">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="HA Setup">
    <meta name="twitter:description" content="Set up Zabbix High Availability with clustered servers, shared DB, and Keepalived for VIP failover—ensuring zero-downtime monitoring.">
    <meta name="twitter:image" content="https://www.thezabbixbook.com/assets/social-card.jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="627">

  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#configuracao-do-ha" class="md-skip">
          Pular para conteúdo
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
            
    
    
    
    
    <script>
        const gGMC_SELECT_VERSION = "Selecione a versão";
        const gGMC_TRANSLATE_CTA = "Ajude-nos a traduzir!";
        const gGMC_PAGE_LOCALE = "pt_BR";
        const gGMC_FILE_LOCALE = "pt_BR";
        const gGMC_TRANSLATE_SVG = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.5 12c0-.68-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2 0 .37-.03.73-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10C6.47 2 2 6.5 2 12s4.5 10 10 10c.59 0 1.16-.06 1.72-.16A5.9 5.9 0 0 1 13 19c0-.29.03-.57.07-.85-.32.63-.67 1.24-1.07 1.81-.83-1.2-1.5-2.53-1.91-3.96h3.72a5.95 5.95 0 0 1 2.59-2.4c.06-.53.1-1.06.1-1.6M12 4.03c.83 1.2 1.5 2.54 1.91 3.97h-3.82c.41-1.43 1.08-2.77 1.91-3.97M4.26 14C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2s.06 1.34.14 2zm.82 2H8c.35 1.25.8 2.45 1.4 3.56A8 8 0 0 1 5.08 16M8 8H5.08A7.92 7.92 0 0 1 9.4 4.44C8.8 5.55 8.35 6.75 8 8m6.34 6H9.66c-.1-.66-.16-1.32-.16-2s.06-1.35.16-2h4.68c.09.65.16 1.32.16 2s-.07 1.34-.16 2m.25-9.56c1.84.63 3.37 1.9 4.33 3.56h-2.95a15.7 15.7 0 0 0-1.38-3.56M23 18v2h-3v3h-2v-3h-3v-2h3v-3h2v3z"/></svg>';
    </script>
    
    

          </div>
          
        </aside>
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabeçalho">
    <a href="../../" title="Zabbix Book" class="md-header__button md-logo" aria-label="Zabbix Book" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Zabbix Book
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              HA Setup
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="light-blue" data-md-color-accent="light-blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Selecione o idioma">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="../../../fr/ch01-zabbix-components/ha-setup/" hreflang="fr" class="md-select__link">
              Français
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../../nl/ch01-zabbix-components/ha-setup/" hreflang="nl" class="md-select__link">
              Nederlands
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="./" hreflang="pt_BR" class="md-select__link">
              Brazillian Portugese
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../../ru/ch01-zabbix-components/ha-setup/" hreflang="ru" class="md-select__link">
              Russian
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../../ch01-zabbix-components/ha-setup/" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Buscar" placeholder="Buscar" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Pesquisar">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Compartilhar" aria-label="Compartilhar" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Limpar" aria-label="Limpar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando busca
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/penmasters/zabbix-book" title="Ir para repositório" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    penmasters
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navegação" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../" title="Zabbix Book" class="md-nav__button md-logo" aria-label="Zabbix Book" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Zabbix Book
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/penmasters/zabbix-book" title="Ir para repositório" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    penmasters
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Welcome
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Guidelines/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Guidelines
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tags/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Book Tags
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Supporters-Contributors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Supporters and contributors
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../ch00-getting-started/initial-steps/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Getting started
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Chapter 01 : Zabbix components
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Chapter 01 : Zabbix components
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Zabbix components
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../basic-installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Basic Installation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    HA Setup
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    HA Setup
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Índice">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Índice
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#instalacao-do-banco-de-dados" class="md-nav__link">
    <span class="md-ellipsis">
      
        Instalação do banco de dados
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#instalando-o-cluster-no-zabbix" class="md-nav__link">
    <span class="md-ellipsis">
      
        Instalando o cluster no Zabbix
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Instalando o cluster no Zabbix">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuracao-do-zabbix-server-1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuração do Zabbix Server 1
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuracao-do-zabbix-server-2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuração do Zabbix Server 2
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iniciando-o-zabbix-server" class="md-nav__link">
    <span class="md-ellipsis">
      
        Iniciando o Zabbix Server
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verificacao-da-configuracao" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verificação da configuração
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#instalando-o-front-end" class="md-nav__link">
    <span class="md-ellipsis">
      
        Instalando o front-end
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Instalando o front-end">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuracao-do-keepalived" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuração do keepalived
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instalar-e-configurar-o-front-end" class="md-nav__link">
    <span class="md-ellipsis">
      
        Instalar e configurar o front-end
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configurar-o-servidor-da-web" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configurar o servidor da Web
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verificar-o-funcionamento-correto" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verificar o funcionamento correto
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusao" class="md-nav__link">
    <span class="md-ellipsis">
      
        Conclusão
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#perguntas" class="md-nav__link">
    <span class="md-ellipsis">
      
        Perguntas
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#urls-uteis" class="md-nav__link">
    <span class="md-ellipsis">
      
        URLs úteis
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../ch02-zabbix-installation/chapter/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Chapter 02 : Installation
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../ch03-zabbix-proxies/chapter/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Chapter 03 : Proxies and Webcomponents
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../ch04-zabbix-collecting-data/chapter/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Chapter 04 : Collecting data 
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../ch05-zabbix-triggers/chapter/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Chapter 05 : Triggers
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../ch06-zabbix-templates/chapter/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Chapter 06 : Templates
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../ch07-zabbix-alerts/chapter/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Chapter 07 : Alerting
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../ch08-zabbix-lld/chapter/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Chapter 08 : LLD
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../ch09-zabbix-extending/chapter/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Chapter 09 : Extending Zabbix
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../ch10-zabbix-discovery/chapter/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Chapter 10 : Discovery
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../ch11-zabbix-visualisation/chapter/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Chapter 11 : Visualisation
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../ch12-zabbix-api/chapter/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Chapter 12 : Zabbix API
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../ch13-advanced-security/chapter/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Chapter 13 : Advanced set up and security
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../ch14-zabbix-maintenance/chapter/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Chapter 14 : Maintenance
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../ch15-zabbix-real-world-examples/chapter/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Chapter 15 : Real world examples
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../print_page/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Print Site
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Índice">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Índice
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#instalacao-do-banco-de-dados" class="md-nav__link">
    <span class="md-ellipsis">
      
        Instalação do banco de dados
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#instalando-o-cluster-no-zabbix" class="md-nav__link">
    <span class="md-ellipsis">
      
        Instalando o cluster no Zabbix
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Instalando o cluster no Zabbix">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuracao-do-zabbix-server-1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuração do Zabbix Server 1
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuracao-do-zabbix-server-2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuração do Zabbix Server 2
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iniciando-o-zabbix-server" class="md-nav__link">
    <span class="md-ellipsis">
      
        Iniciando o Zabbix Server
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verificacao-da-configuracao" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verificação da configuração
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#instalando-o-front-end" class="md-nav__link">
    <span class="md-ellipsis">
      
        Instalando o front-end
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Instalando o front-end">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuracao-do-keepalived" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuração do keepalived
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instalar-e-configurar-o-front-end" class="md-nav__link">
    <span class="md-ellipsis">
      
        Instalar e configurar o front-end
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configurar-o-servidor-da-web" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configurar o servidor da Web
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verificar-o-funcionamento-correto" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verificar o funcionamento correto
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusao" class="md-nav__link">
    <span class="md-ellipsis">
      
        Conclusão
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#perguntas" class="md-nav__link">
    <span class="md-ellipsis">
      
        Perguntas
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#urls-uteis" class="md-nav__link">
    <span class="md-ellipsis">
      
        URLs úteis
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
                



  


  <nav class="md-path" aria-label="Navegação" >
    <ol class="md-path__list">
      
        
  
  
    <li class="md-path__item">
      <a href="../../" class="md-path__link">
        
  <span class="md-ellipsis">
    Welcome
  </span>

      </a>
    </li>
  

      
      
        
  
  
    
    
      <li class="md-path__item">
        <a href="../chapter/" class="md-path__link">
          
  <span class="md-ellipsis">
    Chapter 01 : Zabbix components
  </span>

        </a>
      </li>
    
  

      
    </ol>
  </nav>

              
              <article class="md-content__inner md-typeset">
                


    <a href="../../../print_page/" title="Print Site" class="md-content__button md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 3H6v4h12m1 5a1 1 0 0 1-1-1 1 1 0 0 1 1-1 1 1 0 0 1 1 1 1 1 0 0 1-1 1m-3 7H8v-5h8m3-6H5a3 3 0 0 0-3 3v6h4v4h12v-4h4v-6a3 3 0 0 0-3-3"/></svg>
    </a>



                  







<nav class="md-tags">
  
    
    <span class="md-tag md-tag-icon" data-tag="expert">
      Expert
    </span>
  
</nav>



  
  
    
      
    
    <a href="https://github.com/penmasters/zabbix-book/raw/main/docs/pt_BR/ch01-zabbix-components/ha-setup.md" title="Exibir fonte desta página" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="configuracao-do-ha">Configuração do HA</h1>
<p>Nesta seção, definiremos o Zabbix em uma configuração de alta disponibilidade
(HA). Esse recurso, introduzido no Zabbix 6, é um aprimoramento crucial que
garante o monitoramento contínuo mesmo se um servidor Zabbix falhar. Com a HA,
quando um servidor Zabbix fica inativo, outro pode assumir o controle sem
problemas.</p>
<p>Para este guia, usaremos dois servidores Zabbix e um banco de dados, mas a
configuração permite adicionar mais servidores Zabbix, se necessário.</p>
<p><img alt="Configuração-HA" src="../../../ch01-zabbix-components/ha-setup/ch01-HA-setup.png" /></p>
<p><em>1.1 Configuração de HA</em></p>
<p>É importante observar que a configuração do Zabbix HA é simples, fornecendo
redundância sem recursos complexos, como balanceamento de carga.</p>
<p>Assim como em nossa configuração básica, documentaremos os principais detalhes
dos servidores nessa configuração de HA. Abaixo está a lista de servidores e um
local para adicionar seus respectivos endereços IP para sua conveniência:</p>
<table>
<thead>
<tr>
<th>Servidor</th>
<th>Endereço IP</th>
</tr>
</thead>
<tbody>
<tr>
<td>Servidor Zabbix 1</td>
<td></td>
</tr>
<tr>
<td>Servidor Zabbix 2</td>
<td></td>
</tr>
<tr>
<td>Banco de dados</td>
<td></td>
</tr>
<tr>
<td>IP virtual</td>
<td></td>
</tr>
</tbody>
</table>
<details class="nota" open="open">
<summary>Nota</summary>
<p>Our database (DB) in this setup is not configured for HA. Since it's not a
Zabbix component, you will need to implement your own solution for database
HA, such as a HA SAN or a database cluster setup. A DB cluster configuration
is out of the scope of this guide and unrelated to Zabbix, so it will not be
covered here.</p>
</details>
<hr />
<h2 id="instalacao-do-banco-de-dados">Instalação do banco de dados</h2>
<p>Consulte o capítulo <a href="../basic-installation/"><em>Instalação básica</em></a> para obter
instruções detalhadas sobre a configuração do banco de dados. Esse capítulo
fornece orientação passo a passo sobre a instalação de um banco de dados
PostgreSQL ou MariaDB em um nó dedicado que executa o Ubuntu ou o Rocky Linux.
As mesmas etapas de instalação se aplicam à configuração do banco de dados para
essa instalação.</p>
<hr />
<h2 id="instalando-o-cluster-no-zabbix">Instalando o cluster no Zabbix</h2>
<p>A configuração de um cluster no Zabbix envolve a configuração de vários
servidores Zabbix para trabalharem juntos, proporcionando alta disponibilidade.
Embora o processo seja semelhante à configuração de um único servidor Zabbix, há
etapas adicionais de configuração necessárias para ativar a HA (High
Availability).</p>
<p>Adicione os Repositórios Zabbix aos seus servidores.</p>
<p>Primeiro, adicione o repositório Zabbix a ambos os servidores Zabbix:</p>
<div class="admonition info">
<p class="admonition-title">adicionar repositório zabbix</p>
<p>Redhat</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="l l-Scalar l-Scalar-Plain">rpm -Uvh https://repo.zabbix.com/zabbix/7.2/release/rocky/9/noarch/zabbix-release-latest-7.2.el9.noarch.rpm</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="l l-Scalar l-Scalar-Plain">dnf clean all</span>
</span></code></pre></div>
<p>Ubuntu</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="l l-Scalar l-Scalar-Plain">sudo wget https://repo.zabbix.com/zabbix/7.2/release/ubuntu/pool/main/z/zabbix-release/zabbix-release_latest_7.2+ubuntu24.04_all.deb</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="l l-Scalar l-Scalar-Plain">sudo dpkg -i zabbix-release_latest_7.2+ubuntu24.04_all.deb</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="l l-Scalar l-Scalar-Plain">sudo apt update</span>
</span></code></pre></div>
</div>
<p>Quando isso for feito, poderemos instalar os pacotes do servidor zabbix.</p>
<div class="admonition info">
<p class="admonition-title">instalar pacotes do servidor zabbix</p>
<p>Redhat</p>
<p><div class="language-yaml highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="l l-Scalar l-Scalar-Plain">dnf install zabbix-server-pgsql</span>
</span></code></pre></div>
or if your database is MySQL or MariaDB
<div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>dnf install zabbix-server-mysql
</span></code></pre></div></p>
<p>Ubuntu</p>
<p><div class="language-yaml highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="l l-Scalar l-Scalar-Plain">sudo apt install zabbix-server-pgsql</span>
</span></code></pre></div>
or if your database is MySQL or MariaDB
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="l l-Scalar l-Scalar-Plain">sudo apt install zabbix-server-mysql</span>
</span></code></pre></div></p>
</div>
<hr />
<h3 id="configuracao-do-zabbix-server-1">Configuração do Zabbix Server 1</h3>
<p>Edite o arquivo de configuração do servidor Zabbix,</p>
<div class="admonition info">
<p class="admonition-title">editar o arquivo de configuração do servidor</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="l l-Scalar l-Scalar-Plain">sudo vi /etc/zabbix/zabbix_server.conf</span>
</span></code></pre></div>
</div>
<p>Atualize as seguintes linhas para se conectar ao banco de dados:</p>
<div class="admonition informações">
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="l l-Scalar l-Scalar-Plain">DBHost=&lt;zabbix db ip&gt;</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="l l-Scalar l-Scalar-Plain">DBName=&lt;name of the zabbix DB&gt;</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="l l-Scalar l-Scalar-Plain">DBUser=&lt;name of the db user&gt;</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="l l-Scalar l-Scalar-Plain">DBSchema=&lt;db schema for the PostgreSQL DB&gt;</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="l l-Scalar l-Scalar-Plain">DBPassword=&lt;your secret password&gt;</span>
</span></code></pre></div>
</div>
<p>Configure os parâmetros de HA para esse servidor:</p>
<div class="admonition informações">
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="l l-Scalar l-Scalar-Plain">HANodeName=zabbix1 (or choose a name you prefer)</span>
</span></code></pre></div>
</div>
<p>Especifique o endereço do nó front-end para cenários de failover:</p>
<div class="admonition informações">
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="l l-Scalar l-Scalar-Plain">NodeAddress=&lt;Zabbix server 1 ip&gt;:10051</span>
</span></code></pre></div>
</div>
<hr />
<h3 id="configuracao-do-zabbix-server-2">Configuração do Zabbix Server 2</h3>
<p>Repita as etapas de configuração para o segundo servidor Zabbix. Ajuste o
<code>HANodeName</code> e o <code>NodeAddress</code> conforme necessário para esse servidor.</p>
<hr />
<h3 id="iniciando-o-zabbix-server">Iniciando o Zabbix Server</h3>
<p>Depois de configurar os dois servidores, ative e inicie o serviço zabbix-server
em cada um deles:</p>
<p>!!! info "restart zabbix-server service" (reiniciar o serviço zabbix-server)</p>
<div class="language-text highlight"><pre><span></span><code>```
sudo systemctl enable zabbix-server --now
```
</code></pre></div>
<details class="nota" open="open">
<summary>Nota</summary>
<p>The <code>NodeAddress</code> must match the IP or FQDN name of the Zabbix server node.
Without this parameter the Zabbix front-end is unable to connect to the active
node. The result will be that the frontend is unable to display the status
the queue and other information.</p>
</details>
<hr />
<h3 id="verificacao-da-configuracao">Verificação da configuração</h3>
<p>Verifique os arquivos de registro em ambos os servidores para garantir que eles
tenham sido iniciados corretamente e estejam operando em seus respectivos modos
HA.</p>
<p>No primeiro servidor:</p>
<div class="admonition info">
<p class="admonition-title">verifique se há mensagens de HA nos registros</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="l l-Scalar l-Scalar-Plain">sudo grep HA /var/log/zabbix/zabbix_server.log</span>
</span></code></pre></div>
</div>
<p>Nos logs do sistema, observe as seguintes entradas, indicando a inicialização do
gerenciador de alta disponibilidade (HA):</p>
<div class="admonition informações">
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="l l-Scalar l-Scalar-Plain">22597:20240309:155230.353 starting HA manager</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="l l-Scalar l-Scalar-Plain">22597:20240309:155230.362 HA manager started in active mode</span>
</span></code></pre></div>
</div>
<p>Essas mensagens de registro confirmam que o processo do gerenciador de HA foi
iniciado e assumiu a função ativa. Isso significa que a instância do Zabbix é
agora o nó primário no cluster de HA, lidando com todas as operações de
monitoramento. Se ocorrer um evento de failover, outro nó de espera assumirá o
controle com base na estratégia de HA configurada.</p>
<p>No segundo servidor (e em quaisquer nós adicionais):</p>
<div class="admonition informações">
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="l l-Scalar l-Scalar-Plain">grep HA /var/log/zabbix/zabbix_server.log</span>
</span></code></pre></div>
</div>
<p>Nos logs do sistema, as seguintes entradas indicam a inicialização do
gerenciador de alta disponibilidade (HA):</p>
<div class="admonition informações">
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="l l-Scalar l-Scalar-Plain">22304:20240309:155331.163 starting HA manager</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="l l-Scalar l-Scalar-Plain">22304:20240309:155331.174 HA manager started in standby mode</span>
</span></code></pre></div>
</div>
<p>Essas mensagens confirmam que o processo do gerenciador de HA foi invocado e
iniciado com sucesso no modo de espera. Isso sugere que o nó está operacional,
mas não está atuando no momento como a instância de HA ativa, aguardando outras
transições de estado com base na estratégia de HA configurada.</p>
<p>Nesta etapa, seu cluster do Zabbix está configurado com sucesso para alta
disponibilidade (HA). Os registros do sistema confirmam que o gerenciador de HA
foi inicializado e está sendo executado no modo de espera, indicando que os
mecanismos de failover estão em vigor. Essa configuração garante o monitoramento
ininterrupto, mesmo no caso de falha do servidor, permitindo transições
automáticas de função com base na configuração de HA.</p>
<hr />
<h2 id="instalando-o-front-end">Instalando o front-end</h2>
<p>Antes de prosseguir com a instalação e a configuração do servidor Web, é
essencial instalar o Keepalived. O Keepalived permite o uso de um IP virtual
(VIP) para serviços de front-end, garantindo um failover perfeito e a
continuidade do serviço. Ele fornece uma estrutura robusta para balanceamento de
carga e alta disponibilidade, o que o torna um componente essencial para a
manutenção de uma infraestrutura resiliente.</p>
<hr />
<h3 id="configuracao-do-keepalived">Configuração do keepalived</h3>
<details class="nota" open="open">
<summary>Nota</summary>
<p>Keepalived is like a helper that makes sure one computer takes over if another
one stops working. It gives them a shared magic IP address so users don't notice
when a server fails. If the main one breaks, the backup jumps in right away.
You can replace it with tools like Pacemaker, Corosync, or cloud load balancers
that do the same “take over” job. So let's get started. On both our servers
we have to install keepalived.</p>
</details>
<div class="admonition info">
<p class="admonition-title">instalar keepalived</p>
<p>Redhat
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="l l-Scalar l-Scalar-Plain">dnf install keepalived</span>
</span></code></pre></div></p>
<p>Ubuntu
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="l l-Scalar l-Scalar-Plain">sudo apt install keepalived</span>
</span></code></pre></div></p>
</div>
<p>Em seguida, precisamos modificar a configuração do Keepalived em ambos os
servidores. Embora as configurações sejam semelhantes, cada servidor requer
pequenos ajustes. Começaremos com o Servidor 1. Para editar o arquivo de
configuração do Keepalived, use o seguinte comando:</p>
<div class="admonition info">
<p class="admonition-title">editar a configuração do keepalived</p>
<p>RedHat and Ubuntu
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="l l-Scalar l-Scalar-Plain">sudo vi /etc/keepalived/keepalived.conf</span>
</span></code></pre></div></p>
</div>
<p>Se o arquivo contiver algum conteúdo existente, ele deverá ser limpo e
substituído pelas seguintes linhas:</p>
<div class="admonition informações">
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="l l-Scalar l-Scalar-Plain">vrrp_track_process track_nginx {</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">process nginx</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">weight 10</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="l l-Scalar l-Scalar-Plain">}</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="l l-Scalar l-Scalar-Plain">vrrp_instance VI_1 {</span>
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">state MASTER</span>
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">interface enp0s1</span>
</span><span id="__span-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">virtual_router_id 51</span>
</span><span id="__span-18-10"><a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">priority 244</span>
</span><span id="__span-18-11"><a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">advert_int 1</span>
</span><span id="__span-18-12"><a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">authentication {</span>
</span><span id="__span-18-13"><a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a><span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">auth_type PASS</span>
</span><span id="__span-18-14"><a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a><span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">auth_pass 12345</span>
</span><span id="__span-18-15"><a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">}</span>
</span><span id="__span-18-16"><a id="__codelineno-18-16" name="__codelineno-18-16" href="#__codelineno-18-16"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">virtual_ipaddress {</span>
</span><span id="__span-18-17"><a id="__codelineno-18-17" name="__codelineno-18-17" href="#__codelineno-18-17"></a><span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">xxx.xxx.xxx.xxx</span>
</span><span id="__span-18-18"><a id="__codelineno-18-18" name="__codelineno-18-18" href="#__codelineno-18-18"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">}</span>
</span><span id="__span-18-19"><a id="__codelineno-18-19" name="__codelineno-18-19" href="#__codelineno-18-19"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">track_process {</span>
</span><span id="__span-18-20"><a id="__codelineno-18-20" name="__codelineno-18-20" href="#__codelineno-18-20"></a><span class="w">         </span><span class="l l-Scalar l-Scalar-Plain">track_nginx</span>
</span><span id="__span-18-21"><a id="__codelineno-18-21" name="__codelineno-18-21" href="#__codelineno-18-21"></a><span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">}</span>
</span><span id="__span-18-22"><a id="__codelineno-18-22" name="__codelineno-18-22" href="#__codelineno-18-22"></a><span class="l l-Scalar l-Scalar-Plain">}</span>
</span></code></pre></div>
</div>
<details class="aviso" open="open">
<summary>Aviso</summary>
<p>Replace <code>enp0s1</code> with the interface name of your machine and replace the <code>password</code>
with something secure. For the virtual_ipaddress use a free IP from your network.
This will be used as our VIP.</p>
</details>
<p>Agora podemos fazer a mesma modificação em nosso servidor <code>second</code> Zabbix.
Exclua tudo novamente no mesmo arquivo, como fizemos antes, e substitua-o pelas
seguintes linhas:</p>
<div class="admonition info">
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="l l-Scalar l-Scalar-Plain">vrrp_track_process track_nginx {</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">process nginx</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">weight 10</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="l l-Scalar l-Scalar-Plain">}</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="l l-Scalar l-Scalar-Plain">vrrp_instance VI_1 {</span>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">state BACKUP</span>
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">interface enp0s1</span>
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">virtual_router_id 51</span>
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">priority 243</span>
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">advert_int 1</span>
</span><span id="__span-19-12"><a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">authentication {</span>
</span><span id="__span-19-13"><a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a><span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">auth_type PASS</span>
</span><span id="__span-19-14"><a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a><span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">auth_pass 12345</span>
</span><span id="__span-19-15"><a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">}</span>
</span><span id="__span-19-16"><a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">virtual_ipaddress {</span>
</span><span id="__span-19-17"><a id="__codelineno-19-17" name="__codelineno-19-17" href="#__codelineno-19-17"></a><span class="w">       </span><span class="l l-Scalar l-Scalar-Plain">xxx.xxx.xxx.xxx</span>
</span><span id="__span-19-18"><a id="__codelineno-19-18" name="__codelineno-19-18" href="#__codelineno-19-18"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">}</span>
</span><span id="__span-19-19"><a id="__codelineno-19-19" name="__codelineno-19-19" href="#__codelineno-19-19"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">track_process {</span>
</span><span id="__span-19-20"><a id="__codelineno-19-20" name="__codelineno-19-20" href="#__codelineno-19-20"></a><span class="w">         </span><span class="l l-Scalar l-Scalar-Plain">track_nginx</span>
</span><span id="__span-19-21"><a id="__codelineno-19-21" name="__codelineno-19-21" href="#__codelineno-19-21"></a><span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">}</span>
</span><span id="__span-19-22"><a id="__codelineno-19-22" name="__codelineno-19-22" href="#__codelineno-19-22"></a><span class="l l-Scalar l-Scalar-Plain">}</span>
</span></code></pre></div>
</div>
<p>Assim como em nosso primeiro servidor Zabbix, substitua <code>enp0s1</code> pelo nome da
interface de sua máquina e substitua a senha `` por sua senha e preencha o
virtual_ipaddress como usado anteriormente.</p>
<p>Isso encerra a configuração do keepalived. Agora podemos continuar adaptando o
frontend.</p>
<hr />
<h3 id="instalar-e-configurar-o-front-end">Instalar e configurar o front-end</h3>
<p>Em ambos os servidores, podemos executar os seguintes comandos para instalar
nosso servidor Web e os pacotes de front-end do zabbix:</p>
<p>!!! info "install web server and config" (instalar servidor da web e
configuração)</p>
<div class="language-text highlight"><pre><span></span><code>RedHat
```yaml
dnf install nginx zabbix-web-pgsql zabbix-nginx-conf
```

Ubuntu
```yaml
sudo apt install nginx zabbix-frontend-php php8.3-pgsql zabbix-nginx-conf
```
</code></pre></div>
<p>Além disso, é fundamental configurar o firewall. Regras adequadas de firewall
garantem uma comunicação perfeita entre os servidores e evitam falhas
inesperadas. Antes de prosseguir, verifique se as portas necessárias estão
abertas e aplique as regras de firewall necessárias de acordo.</p>
<div class="admonition info">
<p class="admonition-title">configurar o firewall</p>
<p>RedHat
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="l l-Scalar l-Scalar-Plain">firewall-cmd --add-service=http --permanent</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="l l-Scalar l-Scalar-Plain">firewall-cmd --add-service=zabbix-server --permanent</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="l l-Scalar l-Scalar-Plain">firewall-cmd --reload</span>
</span></code></pre></div></p>
<p>Ubuntu
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="l l-Scalar l-Scalar-Plain">sudo ufw allow 10051/tcp</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="l l-Scalar l-Scalar-Plain">sudo ufw allow 80/tcp</span>
</span></code></pre></div></p>
</div>
<p>Com a configuração em vigor e o firewall devidamente configurado, podemos agora
iniciar o serviço Keepalived. Além disso, devemos ativá-lo para garantir que ele
seja iniciado automaticamente na reinicialização. Use os seguintes comandos para
fazer isso:</p>
<div class="admonition info">
<p class="admonition-title">iniciar e ativar o keepalived</p>
<p>RedHat and Ubuntu
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="l l-Scalar l-Scalar-Plain">sudo systemctl enable keepalived nginx --now</span>
</span></code></pre></div></p>
</div>
<hr />
<h3 id="configurar-o-servidor-da-web">Configurar o servidor da Web</h3>
<p>O processo de configuração do frontend segue as mesmas etapas descritas na seção
<code>Basic Installation</code> em <a href="../basic-installation/#installing-the-frontend">Installing the
Frontend</a>. Ao aderir a esses
procedimentos estabelecidos, garantimos consistência e confiabilidade na
implementação.</p>
<details class="aviso" open="open">
<summary>Aviso</summary>
<p>Ubuntu users need to use the VIP in the setup of Nginx, together with the local
IP in the listen directive of the config.</p>
</details>
<details class="nota" open="open">
<summary>Nota</summary>
<p>Don't forget to configure both front-ends. Also this is a new setup. Keep in
mind that with an existing setup we need to comment out the lines  <code>$ZBX_SERVER</code>
and <code>$ZBX_SERVER_PORT</code>. Our frontend will check what node is active by reading
the node table in the database.</p>
</details>
<div class="admonition informações">
<p><div class="language-yaml highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="l l-Scalar l-Scalar-Plain">select * from ha_node;</span>
</span></code></pre></div>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="n">zabbix</span><span class="o">=#</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">ha_node</span><span class="p">;</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="w">         </span><span class="n">ha_nodeid</span><span class="w">         </span><span class="o">|</span><span class="w">  </span><span class="n">name</span><span class="w">   </span><span class="o">|</span><span class="w">   </span><span class="n">address</span><span class="w">       </span><span class="o">|</span><span class="w"> </span><span class="n">port</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">lastaccess</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">|</span><span class="w">       </span><span class="n">ha_sessionid</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="c1">---------------------------+---------+-----------------+-------+------------+--------+---------------------------</span>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="w"> </span><span class="n">cm8agwr2b0001h6kzzsv19ng6</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">zabbix1</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">xxx</span><span class="p">.</span><span class="n">xxx</span><span class="p">.</span><span class="n">xxx</span><span class="p">.</span><span class="n">xxx</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">10051</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">1742133911</span><span class="w"> </span><span class="o">|</span><span class="w">      </span><span class="mi">0</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">cm8apvb0c0000jkkzx1ojuhst</span>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="w"> </span><span class="n">cm8agyv830001ell0m2nq5o6n</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">zabbix2</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">localhost</span><span class="w">       </span><span class="o">|</span><span class="w"> </span><span class="mi">10051</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">1742133911</span><span class="w"> </span><span class="o">|</span><span class="w">      </span><span class="mi">3</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">cm8ap7b8u0000jil0845p0w51</span>
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="k">rows</span><span class="p">)</span>
</span></code></pre></div></p>
</div>
<p>Nesse caso, o nó <code>zabbix2</code> é identificado como o nó ativo, conforme indicado por
seu valor de status <code>3</code>, que designa um estado ativo. Os valores de status
possíveis são os seguintes:</p>
<ul>
<li><code>0</code> - Vários nós podem permanecer em modo de espera.</li>
<li><code>1</code> - Um nó detectado anteriormente foi desligado.</li>
<li><code>2</code> - Um nó foi detectado anteriormente, mas ficou indisponível sem um
  desligamento adequado.</li>
<li><code>3</code> - O nó está ativo no momento.</li>
</ul>
<p>Essa classificação permite o monitoramento eficaz e o gerenciamento de estado
dentro do cluster.</p>
<hr />
<h3 id="verificar-o-funcionamento-correto">Verificar o funcionamento correto</h3>
<p>Para verificar se a configuração está funcionando corretamente, acesse o
servidor <code>Zabbix</code> usando o IP virtual (VIP). Navegue até Reports → System
Information (Relatórios → Informações do sistema) no menu. Na parte inferior da
página, você deverá ver uma lista de servidores, com pelo menos um marcado como
ativo. O número de servidores exibidos dependerá do total configurado em sua
configuração de HA.</p>
<p><img alt="1º frontend ativo" src="../../../ch01-zabbix-components/ha-setup/ch01-HA-check1.png" /></p>
<p><em>1.2 verificar HA</em></p>
<p>Desligue ou reinicie o servidor de front-end ativo e observe que o front-end
<code>Zabbix</code> permanece acessível. Ao recarregar a página, você notará que o outro
servidor de front-end `` assumiu o papel de instância ativa, garantindo um
failover quase perfeito e alta disponibilidade.</p>
<p><img alt="2st active frontend" src="../../../ch01-zabbix-components/ha-setup/ch01-HA-check2.png" /></p>
<p><em>1.3 verify HA</em></p>
<p>In addition to monitoring the status of HA nodes, Zabbix provides several
runtime commands that allow administrators to manage failover settings and
remove inactive nodes dynamically.</p>
<p>One such command is:</p>
<div class="admonition informações">
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="l l-Scalar l-Scalar-Plain">zabbix_server -R ha_set_failover_delay=10m</span>
</span></code></pre></div>
</div>
<p>This command adjusts the failover delay, which defines how long Zabbix waits
before promoting a standby node to active status. The delay can be set within a
range of <strong>10 seconds</strong> to <strong>15 minutes</strong>.</p>
<p>To remove a node that is either <strong>stopped</strong> or <strong>unreachable</strong>, the following
runtime command must be used:</p>
<div class="admonition informações">
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="l l-Scalar l-Scalar-Plain">zabbix_server -R ha_remove_node=`zabbix1`</span>
</span></code></pre></div>
</div>
<p>Executing this command removes the node from the HA cluster. Upon successful
removal, the output confirms the action:</p>
<div class="admonition informações">
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="l l-Scalar l-Scalar-Plain">Removed node &quot;zabbix1&quot; with ID &quot;cm8agwr2b0001h6kzzsv19ng6&quot;</span>
</span></code></pre></div>
</div>
<p>If the removed node becomes available again, it can be added back automatically
when it reconnects to the cluster. These runtime commands provide flexibility
for managing high availability in Zabbix without requiring a full restart of the
<code>zabbix_server</code> process.</p>
<hr />
<h2 id="conclusao">Conclusão</h2>
<p>In this chapter, we have successfully set up a high-availability (HA) Zabbix
environment by configuring both the Zabbix server and frontend for redundancy.
We first established HA for the Zabbix server, ensuring that monitoring services
remain available even in the event of a failure. Next, we focused on the
frontend, implementing a Virtual IP (VIP) with Keepalived to provide seamless
failover and continuous accessibility.</p>
<p>Additionally, we configured the firewall to allow Keepalived traffic and ensured
that the service starts automatically after a reboot. With this setup, the
Zabbix frontend can dynamically switch between servers, minimizing downtime and
improving reliability.</p>
<p>While database HA is an important consideration, it falls outside the scope of
this setup. However, this foundation provides a robust starting point for
building a resilient monitoring infrastructure that can be further enhanced as
needed.</p>
<hr />
<h2 id="perguntas">Perguntas</h2>
<ol>
<li>What is Zabbix High Availability (HA), and why is it important?</li>
<li>How does Zabbix determine which node is active in an HA setup?</li>
<li>Can multiple Zabbix nodes be active simultaneously in an HA cluster? Why or
   why not?</li>
<li>What configuration file(s) are required to enable HA in Zabbix?</li>
</ol>
<hr />
<h2 id="urls-uteis">URLs úteis</h2>
<ul>
<li><a href="https://www.redhat.com/sysadmin/advanced-keepalived">https://www.redhat.com/sysadmin/advanced-keepalived</a></li>
<li><a href="https://keepalived.readthedocs.io/en/latest/introduction.html">https://keepalived.readthedocs.io/en/latest/introduction.html</a></li>
<li><a href="https://www.zabbix.com/documentation/7.2/en/manual/concepts/server/ha">https://www.zabbix.com/documentation/7.2/en/manual/concepts/server/ha</a></li>
</ul>







  
  






                

              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Voltar para o topo
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 Stichting The Monitoring Penmasters
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["content.tags", "navigation.expand", "navigation.prune", "navigation.path", "navigation.indexes", "navigation.top", "search.suggest", "search.highlight", "search.share", "content.code.copy", "content.action.view", "content.tags"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": {"index": "tags.md"}, "translations": {"clipboard.copied": "Copiado para \u00e1rea de transfer\u00eancia", "clipboard.copy": "Copiar para \u00e1rea de transfer\u00eancia", "search.result.more.one": "mais 1 nesta p\u00e1gina", "search.result.more.other": "# mais nesta p\u00e1gina", "search.result.none": "Nenhum documento encontrado", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Digite para iniciar a busca", "search.result.term.missing": "Ausente", "select.version": "Selecione a vers\u00e3o"}, "version": null}</script>
    
    
    
    
      <script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../../js/print-site.js"></script>
      
        <script src="../../../js/print-site.js"></script>
      
        <script src="../../../js/print-site.js"></script>
      
        <script src="../../../js/print-site.js"></script>
      
        <script src="../../../assets/external/cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../../javascripts/tags-data-attr.js"></script>
      
    
    
        
		
		
    

  </body>
</html>